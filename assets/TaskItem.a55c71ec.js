var ee=Object.defineProperty,te=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var F=(o,t,n)=>t in o?ee(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,v=(o,t)=>{for(var n in t||(t={}))ne.call(t,n)&&F(o,n,t[n]);if(w)for(var n of w(t))ae.call(t,n)&&F(o,n,t[n]);return o},H=(o,t)=>te(o,oe(t));import{D as I,r as d,k as a,a1 as S,j as e,K as D,L as T,u as y,h as b,Z as se,E as re,G as B,H as le,I as A,J as M,a2 as z,N as R,P as ce,l as ie,S as de,aA as pe,n as ue,p as he,aB as ge,aC as Ce,aD as xe,aE as me,a4 as E,Q as O,aF as U,aG as L,aH as ke,aI as fe,aJ as Te,aK as ye,aL as be,aM as Pe,aN as Se,ap as ve,Y as q,ar as He,X as W,aq as De,aa as _,q as Ee,aO as G,aP as N,ao as Oe}from"./vendor.3fc7063a.js";import{T as j,P as J,d as K,A as k,e as je,S as we,f as P,u as Q,g as Fe,i as Ie,j as V,k as Be}from"./index.9ad73d2c.js";const Ae=({onCloseEditor:o})=>{const{projectId:t}=I(),{user:n}=d.exports.useContext(j),[r,l]=d.exports.useState(""),[s,p]=d.exports.useState(""),[c,u]=d.exports.useState(t!=null?t:""),h=d.exports.useRef(null);d.exports.useEffect(()=>{var i;(i=h.current)==null||i.focus()},[]);const g=i=>{l(i.target.value)},f=i=>{p(i)},x=i=>{u(i)},m=async()=>{try{await je({taskName:r,projectId:c,userId:n.uid,due:s})}catch(i){console.log(i)}l("")};return a(S,{mt:2,children:[e(D,{placeholder:"Task name",value:r,onChange:g,ref:h}),a(T,{spacing:2,children:[e(J,{onSelectDate:f}),e(K,{projectId:c!=null?c:"",onSelectProject:x})]}),a(T,{mt:2,ml:4,spacing:2,children:[e(k,{btnType:"primary",text:"Add task",onClick:m,isDisabled:r===""}),e(k,{btnType:"secondary",text:"Cancel",onClick:o})]})]})},Me=()=>{const{isOpen:o,onOpen:t,onClose:n}=y();return o?e(Ae,{onCloseEditor:n}):e(b,{variant:"ghost",isFullWidth:!0,leftIcon:e(se,{}),color:"gray.400",justifyContent:"flex-start",_hover:{color:"red.400"},onClick:t,children:"Add task"})},ze=({isOpen:o,onClose:t,onUpdateProject:n,projectId:r})=>{const{projects:l}=d.exports.useContext(j),s=l.find(i=>i.id===r),[p,c]=d.exports.useState(s.name),[u,h]=d.exports.useState(s.color),g=p===(s==null?void 0:s.name)&&u===(s==null?void 0:s.color);return a(re,{isOpen:o,onClose:t,isCentered:!0,children:[e(B,{}),a(le,{children:[e(A,{children:"Edit project"}),a(M,{children:[a(S,{children:[e(z,{children:"Name"}),e(D,{placeholder:"Project name",value:p,onChange:i=>{c(i.target.value)}})]}),a(S,{children:[e(z,{children:"Color"}),e(we,{onSelectColor:i=>{h(i)},color:u})]})]}),a(R,{children:[e(k,{btnType:"secondary",text:"Cancel",onClick:t}),e(k,{btnType:"primary",text:"Save",onClick:()=>{t(),!g&&n({name:p,color:u})},isDisabled:p===""})]})]})]})},X=({children:o})=>a(ce,{isLazy:!0,closeOnBlur:!0,children:[e(ie,{children:e(de,{icon:e(pe,{}),"aria-label":"popover trigger",variant:"ghost"})}),e(ue,{w:"max",_focus:{border:"1px",borderColor:"gray.300"},boxShadow:"md",children:e(he,{display:"flex",flexDir:"column",children:o})})]}),Y=({onCloseDialog:o,isDialogOpen:t,onDeleteAction:n,deletedItemName:r})=>{const l=d.exports.useRef(null);return e(ge,{isOpen:t,leastDestructiveRef:l,onClose:o,isCentered:!0,children:e(B,{children:a(Ce,{children:[e(A,{children:e(xe,{fontSize:"xl",children:e(me,{})})}),a(M,{children:["Are you sure you want to delete"," ",e(E,{fontWeight:"bold",as:"span",children:r}),"?"]}),a(R,{children:[e(b,{ref:l,onClick:o,variant:"outline",size:"sm",children:"Cancel"}),e(b,{colorScheme:"red",onClick:n,ml:3,size:"sm",children:"Delete"})]})]})})})},Re=({onDeleteProject:o,onOpenEditor:t,projectName:n})=>{const{showCompletedTasks:r,toggleCompletedTasks:l}=d.exports.useContext(j),{isOpen:s,onOpen:p,onClose:c}=y();return a(O,{children:[a(X,{children:[e(P,{icon:e(U,{}),text:"Edit project",onClick:t}),e(P,{icon:e(L,{}),text:"Delete project",onClick:p}),e(P,{icon:r?e(ke,{}):e(fe,{}),text:r?"Hide completed tasks":"Show completed tasks",onClick:()=>{l()}})]}),e(Y,{isDialogOpen:s,onCloseDialog:c,onDeleteAction:o,deletedItemName:n})]})},Ue=()=>{const{isEditing:o,getSubmitButtonProps:t,getCancelButtonProps:n}=Se();return o?a(T,{children:[e(b,H(v({},t()),{color:"white",bg:"red.400",size:"sm",children:"Save"})),a(b,H(v({},n()),{variant:"ghost",size:"sm",children:["Cancel"," "]}))]}):null},Le=({initialValue:o,onChangeTitle:t})=>{let n=Te();const[r,l]=d.exports.useState(o);return d.exports.useEffect(()=>{l(o)},[n]),a(ye,{value:r,isPreviewFocusable:!0,submitOnBlur:!1,selectAllOnFocus:!1,onSubmit:c=>{c!==o&&t(c)},onChange:c=>{l(c)},fontSize:"xl",fontWeight:"bold",mb:4,children:[e(be,{_hover:{background:"gray.300"}}),e(Pe,{mb:2}),e(Ue,{})]})},qe=({projectName:o,projectId:t})=>{let n=ve();const{isOpen:r,onOpen:l,onClose:s}=y();return a(q,{as:"header",children:[t===""?e(He,{fontSize:"xl",mb:4,children:o}):e(Le,{initialValue:o,onChangeTitle:async h=>{await Q(t,{name:h})}}),e(W,{}),t!==""&&e(Re,{onDeleteProject:async()=>{n("/app/inbox"),await Fe(t)},onOpenEditor:l,projectName:o}),t!==""&&r&&e(ze,{isOpen:r,projectName:o,projectId:t,onClose:s,onUpdateProject:async h=>{s(),await Q(t,h)}})]})},Qe=({children:o,projectName:t,projectId:n})=>a(De,{maxW:"3xl",w:"85%",mt:"5.5rem",children:[e(qe,{projectName:t,projectId:n}),e(_,{as:"ul",alignItems:"flex-start",children:o}),e(Me,{})]}),We=({taskName:o,onDeleteTask:t,onOpenEditor:n})=>{const{isOpen:r,onOpen:l,onClose:s}=y();return a(O,{children:[a(X,{children:[e(P,{icon:e(U,{}),text:"Edit task",onClick:n}),e(P,{icon:e(L,{}),text:"Delete task",onClick:l})]}),e(Y,{isDialogOpen:r,onCloseDialog:s,onDeleteAction:t,deletedItemName:o})]})},_e=({isCompleted:o,onToggleCompleted:t})=>a(Ee,{border:o?"none":"1px",borderColor:"gray.400",borderRadius:"50%",w:"20px",h:"20px",cursor:"pointer",mr:"2",onClick:t,children:[!o&&e(G,{as:N,w:"20px",h:"20px",opacity:0,_hover:{opacity:".3",transition:"opacity .25s"}}),o&&e(G,{as:N,w:"20px",h:"20px",color:"gray.500"})]}),Ge=({onCloseEditor:o,taskName:t,due:n,onUpdateTask:r})=>{const{projectId:l}=I(),s=d.exports.useRef(null),[p,c]=d.exports.useState(t),[u,h]=d.exports.useState(n),[g,f]=d.exports.useState(l!=null?l:""),x=p===t&&u===n&&g===l;d.exports.useEffect(()=>{var C;(C=s.current)==null||C.focus()},[]);const m=C=>{c(C.target.value)},i=C=>{h(C)},Z=C=>{f(C)},$=()=>{if(x)return;o(),r({taskName:p,due:u,projectId:g})};return a(S,{children:[e(D,{placeholder:"Task name",value:p,onChange:m,ref:s}),a(T,{spacing:2,children:[e(J,{onSelectDate:i,initialDate:n}),e(K,{projectId:g!=null?g:"",onSelectProject:Z})]}),a(T,{mt:2,ml:4,children:[e(k,{btnType:"primary",text:"Save",onClick:$,isDisabled:p===""}),e(k,{btnType:"secondary",text:"Cancel",onClick:o})]})]})},Ve=({taskName:o,completed:t,id:n,due:r})=>{const l=Oe(),{isOpen:s,onClose:p,onOpen:c}=y(),u=Ie(r);return a(q,{as:"li",w:"full",borderBottom:"1px",borderColor:"gray.200",children:[!s&&a(O,{children:[e(_e,{isCompleted:t,onToggleCompleted:async()=>{try{await V(n,{completed:!t})}catch(x){console.log(x)}}}),a(_,{alignItems:"flex-start",spacing:"0",py:4,children:[e(E,{textDecor:t?"line-through":"none",color:t?"gray.400":"black",children:o}),r&&e(E,{color:"teal",fontSize:"xs",children:u})]}),e(W,{})]}),!t&&!s&&e(We,{onDeleteTask:async()=>{await Be(n)},onOpenEditor:c,taskName:o}),s&&e(Ge,{taskName:o,due:r,onCloseEditor:p,onUpdateTask:async x=>{try{await V(n,x),l({description:"Project change successful!",status:"success",duration:5e3})}catch(m){console.log(m)}}})]})};export{Qe as M,Ve as T};
